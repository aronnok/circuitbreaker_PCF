copied from https://github.com/mkheck/SCSedge-service
Fixed to make it working in PWS 
